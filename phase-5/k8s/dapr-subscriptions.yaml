---
# Subscription: Backend subscribes to task-updates
apiVersion: dapr.io/v2alpha1
kind: Subscription
metadata:
  name: backend-task-updates
  namespace: todo
spec:
  topic: task-updates
  routes:
    default: /events/task-updates
  pubsubname: kafka-pubsub
scopes:
  - backend

---
# Subscription: Notification service subscribes to events
apiVersion: dapr.io/v2alpha1
kind: Subscription
metadata:
  name: notification-task-events
  namespace: todo
spec:
  topic: task-events
  routes:
    default: /events/task-events
  pubsubname: kafka-pubsub
scopes:
  - notification-service

---
# Subscription: Notification service subscribes to reminders
apiVersion: dapr.io/v2alpha1
kind: Subscription
metadata:
  name: notification-reminders
  namespace: todo
spec:
  topic: reminders
  routes:
    default: /events/reminders
  pubsubname: kafka-pubsub
scopes:
  - notification-service

---
# Subscription: Recurring service subscribes to task completion
apiVersion: dapr.io/v2alpha1
kind: Subscription
metadata:
  name: recurring-task-events
  namespace: todo
spec:
  topic: task-events
  routes:
    rules:
      - match: event.type == "completed"
        path: /events/task-completed
  pubsubname: kafka-pubsub
scopes:
  - recurring-service